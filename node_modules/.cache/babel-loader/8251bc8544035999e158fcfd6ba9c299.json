{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\matth\\\\Desktop\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\matth\\\\Desktop\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\matth\\\\Desktop\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\matth\\\\Desktop\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\matth\\\\Desktop\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\matth\\\\Desktop\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{useState}from\"react\";import\"../style/connectionStyle.css\";import{login}from\"./API\";import{Button,TextField,Grid,Paper,Typography}from\"@material-ui/core\";import{Redirect}from\"react-router-dom\";import{connect}from\"react-redux\";var Connection=/*#__PURE__*/function(_React$Component){_inherits(Connection,_React$Component);var _super=_createSuper(Connection);function Connection(props){var _this;_classCallCheck(this,Connection);_this=_super.call(this,props);_this.state={email:'',password:'',loaded:false,loading:false,errorMassage:false,connected:false};return _this;}_createClass(Connection,[{key:\"dissmisError\",value:function dissmisError(){this.setState({error:\"\"});}},{key:\"handleSubmit\",value:function(){var _handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.setState({error:false,errorMessage:\"\",loading:true,loaded:false});_context.prev=1;_context.next=4;return login(this.state.email,this.state.password);case 4:data=_context.sent;if(!(data.user.userRecup.userType!==\"mecano\")){_context.next=7;break;}throw new Error(\"Un client ne peut pas se connecter à l'application!\");case 7:this.props.login(data.user.userRecup);this.setState({connected:true});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);this.setState({error:true,loading:false,loaded:true,errorMessage:_context.t0});case 14:case\"end\":return _context.stop();}}},_callee,this,[[1,11]]);}));function handleSubmit(){return _handleSubmit.apply(this,arguments);}return handleSubmit;}()},{key:\"userChange\",value:function userChange(evt){this.setState({email:evt.target.value});}},{key:\"passwordChange\",value:function passwordChange(evt){this.setState({password:evt.target.value});}},{key:\"render\",value:function render(){var _this2=this;if(this.state.connected){return/*#__PURE__*/React.createElement(Redirect,{to:\"/menu\"});}var contentMessage;if(!this.state.loaded)contentMessage=null;else if(this.state.loading){contentMessage=/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Typography,{component:\"h6\",color:\"error\"},\"Chargement en cours\"),\" \");}else if(this.state.error){contentMessage=/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Typography,{component:\"h6\",color:\"error\"},this.state.errorMassage),\" \");}return/*#__PURE__*/React.createElement(\"div\",{className:\"gridConnection\"},/*#__PURE__*/React.createElement(Grid,{container:true,justify:\"center\",direction:\"row\"},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"column\",justify:\"center\",className:\"login-form\"},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Typography,{component:\"h1\"},\"Se connecter\")),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"column\",spacing:3},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(TextField,{type:\"text\",label:\"Adresse mail\",value:this.state.email,onChange:function onChange(event){return _this2.userChange(event);},required:true,autoFocus:true})),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(TextField,{type:\"password\",label:\"Mot de passe\",value:this.state.password,onChange:function onChange(event){return _this2.passwordChange(event);},onKeyPress:function onKeyPress(event){if(event.code===\"Enter\"||event.code===\"NumpadEnter\"){_this2.dissmisError();_this2.handleSubmit().then();}},required:true})),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Button,{variant:\"contained\",type:\"submit\",className:\"button-block\",onClick:function onClick(){_this2.dissmisError();_this2.handleSubmit();}},\"Connexion\")),contentMessage&&contentMessage))))));}}]);return Connection;}(React.Component);var mapDispatchToProps=function mapDispatchToProps(dispatch){return{login:function login(user){dispatch({type:\"login\",payload:{userInfo:user}});}};};export default connect(undefined,mapDispatchToProps)(Connection);","map":{"version":3,"sources":["C:/Users/matth/Desktop/client_web_avence/src/component/Connection.js"],"names":["React","useState","login","Button","TextField","Grid","Paper","Typography","Redirect","connect","Connection","props","state","email","password","loaded","loading","errorMassage","connected","setState","error","errorMessage","data","user","userRecup","userType","Error","evt","target","value","contentMessage","event","userChange","passwordChange","code","dissmisError","handleSubmit","then","Component","mapDispatchToProps","dispatch","type","payload","userInfo","undefined"],"mappings":"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","sourcesContent":["import React, {useState} from \"react\";\r\nimport \"../style/connectionStyle.css\";\r\nimport {login} from \"./API\";\r\nimport {\r\n    Button,\r\n    TextField,\r\n    Grid,\r\n    Paper,\r\n    Typography\r\n} from \"@material-ui/core\";\r\nimport {Redirect} from \"react-router-dom\";\r\nimport {connect} from \"react-redux\";\r\n\r\n\r\n\r\nclass Connection extends React.Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            email: '',\r\n            password:'',\r\n            loaded:false,\r\n            loading:false,\r\n        errorMassage:false,\r\n        connected:false};\r\n\r\n    }\r\n    dissmisError(){\r\n        this.setState({error:\"\"});\r\n    }\r\n    async handleSubmit(){\r\n        this.setState({error:false,\r\n        errorMessage:\"\",\r\n        loading:true,\r\n        loaded:false});\r\n        try{\r\n            const data = await login(this.state.email,this.state.password);\r\n            if(data.user.userRecup.userType !== \"mecano\") {\r\n                throw new Error(\"Un client ne peut pas se connecter à l'application!\");\r\n            }\r\n            this.props.login(data.user.userRecup);\r\n            this.setState({\r\n                connected:true});\r\n        }catch (error) {\r\n            this.setState({\r\n                error : true,\r\n                loading:false,\r\n                loaded:true,\r\n                errorMessage:error\r\n            });\r\n        }\r\n    }\r\n    userChange(evt){\r\n        this.setState({email:evt.target.value});\r\n    }\r\n    passwordChange(evt){\r\n        this.setState({password:evt.target.value});\r\n    }\r\n\r\n\r\n    render() {\r\n            if(this.state.connected){\r\n                return <Redirect to={\"/menu\"}/>\r\n            }\r\n            let contentMessage;\r\n            if(!this.state.loaded)\r\n                contentMessage = null;\r\n            else if(this.state.loading){\r\n                contentMessage = <Grid item><Typography component={\"h6\"} color={\"error\"}>Chargement en cours</Typography> </Grid>;\r\n            }else if(this.state.error){\r\n                contentMessage = <Grid item><Typography component={\"h6\"} color={\"error\"}>{this.state.errorMassage}</Typography> </Grid>\r\n            }\r\n            return (\r\n                <div className=\"gridConnection\">\r\n                <Grid container  justify={\"center\"} direction={\"row\"}>\r\n                    <Grid item>\r\n                        <Grid container direction={\"column\"} justify={\"center\"} className={\"login-form\"}>\r\n                            <Grid item>\r\n                                <Typography component={\"h1\"}>Se connecter</Typography>\r\n                            </Grid>\r\n                            <Grid item>\r\n                                <Grid container direction={\"column\"} spacing={3}>\r\n                                    <Grid item>\r\n                                        <TextField\r\n                                        type={\"text\"}\r\n                                        label={\"Adresse mail\"}\r\n                                        value={this.state.email}\r\n                                        onChange={(event)=>this.userChange(event)} required={true} autoFocus\r\n                                        />\r\n                                    </Grid>\r\n                                    <Grid item>\r\n                                        <TextField\r\n                                        type={\"password\"}\r\n                                        label={\"Mot de passe\"}\r\n                                        value={this.state.password}\r\n                                        onChange={(event)=>this.passwordChange(event)}\r\n                                        onKeyPress={(event)=>{\r\n                                            if(event.code === \"Enter\" || event.code === \"NumpadEnter\") {\r\n                                                this.dissmisError();\r\n                                                this.handleSubmit().then();\r\n                                            }\r\n                                        }}\r\n                                        required\r\n                                        />\r\n                                    </Grid>\r\n                                    <Grid item>\r\n                                        <Button\r\n                                            variant={\"contained\"}\r\n                                            type={\"submit\"}\r\n                                            className={\"button-block\"}\r\n                                            onClick={()=>{\r\n                                                this.dissmisError();\r\n                                                this.handleSubmit();\r\n                                            }}>\r\n                                            Connexion\r\n                                        </Button>\r\n                                    </Grid>\r\n                                    {contentMessage && contentMessage}\r\n                                </Grid>\r\n                            </Grid>\r\n\r\n                        </Grid>\r\n                    </Grid>\r\n                </Grid>\r\n                </div>\r\n            )\r\n\r\n\r\n    }\r\n}\r\nconst mapDispatchToProps = (dispatch)=>{\r\n    return {\r\n        login : (user)=>{\r\n            dispatch({type:\"login\", payload:{userInfo:user}})\r\n        }\r\n    }\r\n}\r\nexport default connect(undefined,mapDispatchToProps)(Connection);"]},"metadata":{},"sourceType":"module"}