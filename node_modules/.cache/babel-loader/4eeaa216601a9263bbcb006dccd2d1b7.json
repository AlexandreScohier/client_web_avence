{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Alexandre\\\\IdeaProjects\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Alexandre\\\\IdeaProjects\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\Alexandre\\\\IdeaProjects\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Alexandre\\\\IdeaProjects\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\Alexandre\\\\IdeaProjects\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\Alexandre\\\\IdeaProjects\\\\client_web_avence\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from\"react\";import\"./connectionStyle.css\";import{login}from\"../API\";import{connect}from\"react-redux\";import{Redirect}from\"react-router-dom\";var Connection=/*#__PURE__*/function(_React$Component){_inherits(Connection,_React$Component);var _super=_createSuper(Connection);function Connection(props){var _this;_classCallCheck(this,Connection);_this=_super.call(this,props);_this.state={email:'',password:'',loaded:false,loading:false,errorMassage:false,connected:false};return _this;}_createClass(Connection,[{key:\"handleSubmit\",value:function(){var _handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return login(this.state.email,this.state.password);case 3:data=_context.sent;if(!(data.user.userRecup.userType!==\"mecano\")){_context.next=6;break;}throw new Error(\"Un client ne peut pas se connecter à l'application!\");case 6:this.props.login(data.user.userRecup);console.log(this.props.user.userType);this.setState({connected:true});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);this.setState({error:true,loading:false,loaded:true,errorMessage:_context.t0});case 14:case\"end\":return _context.stop();}}},_callee,this,[[0,11]]);}));function handleSubmit(){return _handleSubmit.apply(this,arguments);}return handleSubmit;}()},{key:\"userChange\",value:function userChange(evt){this.setState({email:evt.target.value});}},{key:\"passwordChange\",value:function passwordChange(evt){this.setState({password:evt.target.value});}},{key:\"render\",value:function render(){var _this2=this;if(this.state.connected){return/*#__PURE__*/React.createElement(Redirect,{to:\"/\"});}// // let contentMessage;\n// if(!this.state.loaded)\n//     contentMessage = null;\n// else if(this.state.loading){\n//     contentMessage = <Grid item><Typography component={\"h6\"} color={\"error\"}>Chargement en cours</Typography> </Grid>;\n// }else if(this.state.error){\n//     contentMessage = <Grid item><Typography component={\"h6\"} color={\"error\"}>{this.state.errorMassage}</Typography> </Grid>\n// }\nreturn/*#__PURE__*/React.createElement(\"div\",{className:\"form\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Se connecter\"),/*#__PURE__*/React.createElement(\"form\",{className:\"row g-3\"},/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",type:\"text\",id:\"emailAdresse\",placeholder:\"Adresse mail\",value:this.state.email,onChange:function onChange(event){return _this2.userChange(event);},autoFocus:true,required:true}),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",type:\"text\",id:\"password\",placeholder:\"Password\",value:this.state.password,onChange:function onChange(event){return _this2.passwordChange(event);},required:true}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary\",onClick:function onClick(){_this2.handleSubmit();}},\"Connexion\")));}}]);return Connection;}(React.Component);var mapDispatchToProps=function mapDispatchToProps(dispatch){return{login:function login(user){dispatch({type:\"login\",payload:{userInfo:user}});}};};export default connect(undefined,mapDispatchToProps)(Connection);","map":{"version":3,"sources":["C:/Users/Alexandre/IdeaProjects/client_web_avence/src/component/Login/Connection.js"],"names":["React","login","connect","Redirect","Connection","props","state","email","password","loaded","loading","errorMassage","connected","data","user","userRecup","userType","Error","console","log","setState","error","errorMessage","evt","target","value","event","userChange","passwordChange","handleSubmit","Component","mapDispatchToProps","dispatch","type","payload","userInfo","undefined"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport \"./connectionStyle.css\";\r\nimport {login} from \"../API\";\r\nimport {connect} from \"react-redux\";\r\nimport {Redirect} from \"react-router-dom\";\r\n\r\n\r\n\r\nclass Connection extends React.Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            email: '',\r\n            password:'',\r\n            loaded:false,\r\n            loading:false,\r\n        errorMassage:false,\r\n        connected:false};\r\n    }\r\n\r\n    async handleSubmit(){\r\n        try{\r\n            const data = await login(this.state.email,this.state.password);\r\n            if(data.user.userRecup.userType !== \"mecano\") {\r\n                throw new Error(\"Un client ne peut pas se connecter à l'application!\");\r\n            }\r\n            this.props.login(data.user.userRecup);\r\n            console.log(this.props.user.userType);\r\n            this.setState({connected:true});\r\n        }catch (error) {\r\n            this.setState({\r\n                error : true,\r\n                loading:false,\r\n                loaded:true,\r\n                errorMessage:error\r\n            });\r\n        }\r\n    }\r\n    userChange(evt){\r\n        this.setState({email:evt.target.value});\r\n    }\r\n    passwordChange(evt){\r\n        this.setState({password:evt.target.value});\r\n    }\r\n\r\n\r\n    render() {\r\n            if(this.state.connected){\r\n                return <Redirect to={\"/\"}/>\r\n            }\r\n            // // let contentMessage;\r\n            // if(!this.state.loaded)\r\n            //     contentMessage = null;\r\n            // else if(this.state.loading){\r\n            //     contentMessage = <Grid item><Typography component={\"h6\"} color={\"error\"}>Chargement en cours</Typography> </Grid>;\r\n            // }else if(this.state.error){\r\n            //     contentMessage = <Grid item><Typography component={\"h6\"} color={\"error\"}>{this.state.errorMassage}</Typography> </Grid>\r\n            // }\r\n            return (\r\n                <div className=\"form\">\r\n                    <h1>Se connecter</h1>\r\n                    <form className=\"row g-3\">\r\n                    <input\r\n                     className=\"form-control\"\r\n                     type=\"text\"\r\n                     id=\"emailAdresse\"\r\n                     placeholder=\"Adresse mail\"\r\n                     value = {this.state.email}\r\n                     onChange ={(event)=>this.userChange(event)}\r\n                     autoFocus\r\n                     required\r\n                     ></input>\r\n\r\n                    <input\r\n                    className=\"form-control\"\r\n                    type=\"text\"\r\n                    id=\"password\"\r\n                    placeholder=\"Password\"\r\n                    value = {this.state.password}\r\n                    onChange ={(event)=>this.passwordChange(event)}\r\n                    required\r\n                    ></input>\r\n                    <button \r\n                    type=\"submit\" \r\n                    className=\"btn btn-primary\"\r\n                    onClick ={()=>{\r\n                        this.handleSubmit();\r\n                    }}\r\n                    >Connexion</button>\r\n                    </form>\r\n                </div>\r\n            )\r\n\r\n\r\n    }\r\n}\r\nconst mapDispatchToProps = (dispatch)=>{\r\n    return {\r\n        login : (user)=>{\r\n            dispatch({type:\"login\", payload:{userInfo:user}})\r\n        }\r\n    }\r\n}\r\nexport default connect(undefined,mapDispatchToProps)(Connection);"]},"metadata":{},"sourceType":"module"}