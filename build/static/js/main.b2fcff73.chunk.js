(this["webpackJsonpreact-component"]=this["webpackJsonpreact-component"]||[]).push([[0],{107:function(e,t,a){},108:function(e,t,a){},109:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(7),s=a.n(o),c=(a(75),a(76),a(18)),i=a(19),l=a(21),u=a(20),m=a(32),d=a(11),p=a(25),h=a(15),g=a.n(h),f=a(27),E=(a(83),a(84)),v=function(){var e=Object(f.a)(g.a.mark((function e(t,a){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t||void 0===a){e.next=6;break}return e.next=3,E.login(t,a);case 3:return e.abrupt("return",e.sent);case 6:throw new Error("Identfiants manquants");case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),b=function(){var e=Object(f.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAllGarage();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=a(137),w=a(141),j=a(142),O=a(143),x=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={email:"",password:"",loaded:!1,loading:!1,errorMassage:!1,connected:!1},n}return Object(i.a)(a,[{key:"dissmisError",value:function(){this.setState({error:""})}},{key:"handleSubmit",value:function(){var e=Object(f.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({error:!1,errorMessage:"",loading:!0,loaded:!1}),e.prev=1,e.next=4,v(this.state.email,this.state.password);case 4:if("mecano"===(t=e.sent).user.userRecup.userType){e.next=7;break}throw new Error("Un client ne peut pas se connecter \xe0 l'application!");case 7:this.props.login(t.user.userRecup),this.setState({connected:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.setState({error:!0,loading:!1,loaded:!0,errorMessage:e.t0});case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"userChange",value:function(e){this.setState({email:e.target.value})}},{key:"passwordChange",value:function(e){this.setState({password:e.target.value})}},{key:"render",value:function(){var e,t=this;return this.state.connected?r.a.createElement(d.a,{to:"/menu"}):(this.state.loaded?this.state.loading?e=r.a.createElement(y.a,{item:!0},r.a.createElement(w.a,{component:"h6",color:"error"},"Chargement en cours")," "):this.state.error&&(e=r.a.createElement(y.a,{item:!0},r.a.createElement(w.a,{component:"h6",color:"error"},this.state.errorMassage)," ")):e=null,r.a.createElement("div",{className:"gridConnection"},r.a.createElement(y.a,{container:!0,justify:"center",direction:"row"},r.a.createElement(y.a,{item:!0},r.a.createElement(y.a,{container:!0,direction:"column",justify:"center",className:"login-form"},r.a.createElement(y.a,{item:!0},r.a.createElement(w.a,{component:"h1"},"Se connecter")),r.a.createElement(y.a,{item:!0},r.a.createElement(y.a,{container:!0,direction:"column",spacing:3},r.a.createElement(y.a,{item:!0},r.a.createElement(j.a,{type:"text",label:"Adresse mail",value:this.state.email,onChange:function(e){return t.userChange(e)},required:!0,autoFocus:!0})),r.a.createElement(y.a,{item:!0},r.a.createElement(j.a,{type:"password",label:"Mot de passe",value:this.state.password,onChange:function(e){return t.passwordChange(e)},onKeyPress:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(t.dissmisError(),t.handleSubmit().then())},required:!0})),r.a.createElement(y.a,{item:!0},r.a.createElement(O.a,{variant:"contained",type:"submit",className:"button-block",onClick:function(){t.dissmisError(),t.handleSubmit()}},"Connexion")),e&&e)))))))}}]),a}(r.a.Component),k=Object(p.b)(void 0,(function(e){return{login:function(t){e({type:"login",payload:{userInfo:t}})}}}))(x),N=(a(107),a(108),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={user:n.props.user},n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){}},{key:"render",value:function(){return r.a.createElement("div",{className:"menu"},r.a.createElement(O.a,{variant:"contained",component:m.b,to:"/garages"},"Modifier les garages"),r.a.createElement(O.a,{variant:"contained",component:m.b,to:"/garages"},"Modifier les m\xe9caniciens"),r.a.createElement(O.a,{variant:"contained",onClick:function(){return console.log("Essaie"),r.a.createElement(d.a,{to:"/garages"})}},"Modifier les horaires"),r.a.createElement(O.a,{variant:"contained",onClick:function(){return console.log("Essaie"),r.a.createElement(d.a,{to:"/garages"})}},"Modifier les reparations"))}}]),a}(r.a.Component)),S=Object(p.b)((function(e){return console.log("Matthys"),{user:e.userStore}}),(function(e){return{login:function(t){e({type:"login",payload:{userInfo:t}})}}}))(N),C=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={name:"",address:"",phoneNumber:"",image:""},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Ajouter un garage"),r.a.createElement("input",{type:"text",name:"Nom",value:this.state.name,placeholder:"Nom",required:!0}),r.a.createElement("input",{type:"text",name:"adresse",placeholder:"Adresse",value:this.state.adress,required:!0}),r.a.createElement("input",{type:"text",name:"Num\xe9ro de t\xe9l\xe9phone",placeholder:"Num\xe9ro de t\xe9l\xe9phone",value:this.state.phoneNumber,required:!0}),r.a.createElement("input",{type:"text",name:"image",placeholder:"Url de l'image",value:this.state.image,required:!0}),r.a.createElement("button",{type:"submit"},"Add"))}}]),a}(r.a.Component),A=function(e){var t=e.garage;return r.a.createElement("tr",null,r.a.createElement("td",null,t.nom),r.a.createElement("td",null,t.adresse),r.a.createElement("td",null,t.numtel),r.a.createElement("td",null,r.a.createElement("img",{alt:"",width:"60px",height:"60px",src:t.image})))},M=function(){return r.a.createElement("tr",null,r.a.createElement("input",{type:"text",name:"Nom",value:(void 0).state.name,placeholder:"Nom",required:!0}),r.a.createElement("input",{type:"text",name:"adresse",placeholder:"Adresse",value:(void 0).state.adress,required:!0}),r.a.createElement("input",{type:"text",name:"Num\xe9ro de t\xe9l\xe9phone",placeholder:"Num\xe9ro de t\xe9l\xe9phone",value:(void 0).state.phoneNumber,required:!0}),r.a.createElement("input",{type:"text",name:"image",placeholder:"Url de l'image",value:(void 0).state.image,required:!0}))},q=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={garageTitle:{name:"Nom",address:"adresse",phoneNumber:"Num\xe9ro de t\xe9l\xe9phone",image:"image"},garages:[{nom:"Brxuelles",adresse:"loin",numtel:"04858828"},{nom:"Brxuelles",adresse:"loin",numtel:"04858828"}]},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;b().then((function(t){return e.setState({garages:t})})).catch((function(e){return console.error(e)}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",null,r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,this.state.garageTitle.name),r.a.createElement("th",null,this.state.garageTitle.address),r.a.createElement("th",null,this.state.garageTitle.phoneNumber),r.a.createElement("th",null,this.state.garageTitle.image),r.a.createElement("th",null,"Action"))),r.a.createElement("tbody",null,this.state.garages.map((function(e){return r.a.createElement(n.Fragment,null,r.a.createElement(M,null),r.a.createElement(A,{garage:e}))}))))),r.a.createElement(C,null))}}]),a}(r.a.Component),T=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={user:void 0},n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){void 0===this.state.user&&(console.log("cc"),this.setState({user:this.props.userStore}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(m.a,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/login",component:k}),r.a.createElement(d.b,{path:"/menu",render:function(){return void 0===e.state.user?r.a.createElement(d.a,{to:"/login"}):"mecano"===e.state.user.userType?r.a.createElement(S,null):r.a.createElement(d.a,{to:"/"})}}),r.a.createElement(d.b,{path:"/garages",render:function(){return void 0===e.state.user?r.a.createElement(d.a,{to:"/login"}):"mecano"===e.state.user.userType?r.a.createElement(q,null):r.a.createElement(d.a,{to:"/login"})}}),r.a.createElement(d.b,{path:"/",render:function(){return void 0===e.state.user?r.a.createElement(d.a,{to:"/login"}):"mecano"===e.state.user.userType?r.a.createElement(S,null):r.a.createElement(d.a,{to:"/login"})}}))))}}]),a}(r.a.Component);Object(p.b)((function(e){return console.log(e.login.userStore),{userStore:e.login.userStore}}))(T);var U=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(q,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var B=a(48),I=Object(B.b)(Object(B.a)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{user:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"login":return{userStore:t.payload.userInfo};default:return e}}}));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(p.a,{store:I},r.a.createElement(U,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},70:function(e,t,a){e.exports=a(109)},75:function(e,t,a){},76:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){"use strict";a.r(t),a.d(t,"login",(function(){return u})),a.d(t,"getAllGarage",(function(){return m}));var n=a(15),r=a.n(n),o=a(27),s=a(46),c=a.n(s),i="http://localhost:3001/",l={"Access-Control-Allow-Origin":"*"},u=function(){var e=Object(o.a)(r.a.mark((function e(t,a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.post(i+"user/admin",{adresseMail:t,password:a},{headers:l}).catch((function(e){if(400===e.response.status)throw new Error("Les identifiants n'existent pas dans la base de donn\xe9es");if(404===e.response.status)throw new Error("Utilisateur inconnu pour cet administrateur");if(500===e.response.status)throw new Error("Erreur de connexion")}));case 2:return n=e.sent,l={Authorization:"Bearer "+n.data,"Access-Control-Allow-Origin":"*"},console.log(n.data),e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),m=function(){var e=Object(o.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.get(i+"garage/",{headers:l}).catch((function(e){if(404===e.response.status)throw new Error("Garage inconnu");if(500===e.response.status)throw new Error("Erreur de connexion")}));case 2:return t=e.sent,console.log(JSON.stringify(t.data)),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}},[[70,1,2]]]);
//# sourceMappingURL=main.b2fcff73.chunk.js.map