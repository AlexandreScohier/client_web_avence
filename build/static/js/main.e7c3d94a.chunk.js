(this["webpackJsonpreact-component"]=this["webpackJsonpreact-component"]||[]).push([[0],{109:function(e,t,n){},110:function(e,t,n){},111:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),c=n.n(o),u=(n(77),n(78),n(19)),s=n(20),i=n(22),l=n(21),d=n(32),m=n(12),p=n(26),h=n(9),f=n.n(h),g=n(14),E=(n(85),n(86)),v=function(){var e=Object(g.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t||void 0===n){e.next=6;break}return e.next=3,E.login(t,n);case 3:return e.abrupt("return",e.sent);case 6:throw new Error("Identfiants manquants");case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),b=function(){var e=Object(g.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAllGarage();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(g.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t){e.next=6;break}return e.next=3,E.deleteGarage(t);case 3:return e.abrupt("return",e.sent);case 6:throw new Error("Identifiant du garage incorrect");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(g.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),void 0===t){e.next=7;break}return e.next=4,E.postGarage(t.name,t.address,t.phoneNumber,t.image);case 4:return e.abrupt("return",e.sent);case 7:throw new Error("Erreur composant le garage manquant");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=n(139),C=n(143),j=n(144),x=n(145),O=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={email:"",password:"",loaded:!1,loading:!1,errorMassage:!1,connected:!1},a}return Object(s.a)(n,[{key:"dissmisError",value:function(){this.setState({error:""})}},{key:"handleSubmit",value:function(){var e=Object(g.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({error:!1,errorMessage:"",loading:!0,loaded:!1}),e.prev=1,e.next=4,v(this.state.email,this.state.password);case 4:if("mecano"===(t=e.sent).user.userRecup.userType){e.next=7;break}throw new Error("Un client ne peut pas se connecter \xe0 l'application!");case 7:this.props.login(t.user.userRecup),this.setState({connected:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.setState({error:!0,loading:!1,loaded:!0,errorMessage:e.t0});case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"userChange",value:function(e){this.setState({email:e.target.value})}},{key:"passwordChange",value:function(e){this.setState({password:e.target.value})}},{key:"render",value:function(){var e,t=this;return this.state.connected?r.a.createElement(m.a,{to:"/menu"}):(this.state.loaded?this.state.loading?e=r.a.createElement(k.a,{item:!0},r.a.createElement(C.a,{component:"h6",color:"error"},"Chargement en cours")," "):this.state.error&&(e=r.a.createElement(k.a,{item:!0},r.a.createElement(C.a,{component:"h6",color:"error"},this.state.errorMassage)," ")):e=null,r.a.createElement("div",{className:"gridConnection"},r.a.createElement(k.a,{container:!0,justify:"center",direction:"row"},r.a.createElement(k.a,{item:!0},r.a.createElement(k.a,{container:!0,direction:"column",justify:"center",className:"login-form"},r.a.createElement(k.a,{item:!0},r.a.createElement(C.a,{component:"h1"},"Se connecter")),r.a.createElement(k.a,{item:!0},r.a.createElement(k.a,{container:!0,direction:"column",spacing:3},r.a.createElement(k.a,{item:!0},r.a.createElement(j.a,{type:"text",label:"Adresse mail",value:this.state.email,onChange:function(e){return t.userChange(e)},required:!0,autoFocus:!0})),r.a.createElement(k.a,{item:!0},r.a.createElement(j.a,{type:"password",label:"Mot de passe",value:this.state.password,onChange:function(e){return t.passwordChange(e)},onKeyPress:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(t.dissmisError(),t.handleSubmit().then())},required:!0})),r.a.createElement(k.a,{item:!0},r.a.createElement(x.a,{variant:"contained",type:"submit",className:"button-block",onClick:function(){t.dissmisError(),t.handleSubmit()}},"Connexion")),e&&e)))))))}}]),n}(r.a.Component),S=Object(p.b)(void 0,(function(e){return{login:function(t){e({type:"login",payload:{userInfo:t}})}}}))(O),N=(n(109),n(110),function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={user:a.props.user},a}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){}},{key:"render",value:function(){return r.a.createElement("div",{className:"menu"},r.a.createElement(x.a,{variant:"contained",component:d.b,to:"/garages"},"Modifier les garages"),r.a.createElement(x.a,{variant:"contained",component:d.b,to:"/garages"},"Modifier les m\xe9caniciens"),r.a.createElement(x.a,{variant:"contained",onClick:function(){return console.log("Essaie"),r.a.createElement(m.a,{to:"/garages"})}},"Modifier les horaires"),r.a.createElement(x.a,{variant:"contained",onClick:function(){return console.log("Essaie"),r.a.createElement(m.a,{to:"/garages"})}},"Modifier les reparations"))}}]),n}(r.a.Component)),A=Object(p.b)((function(e){return console.log("Matthys"),{user:e.userStore}}),(function(e){return{login:function(t){e({type:"login",payload:{userInfo:t}})}}}))(N),T=n(38),G=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={name:"",address:"",phoneNumber:"",image:""},a}return Object(s.a)(n,[{key:"nameChange",value:function(e){this.setState({name:e.target.value})}},{key:"addressChange",value:function(e){this.setState({address:e.target.value})}},{key:"phoneNumberChange",value:function(e){this.setState({phoneNumber:e.target.value})}},{key:"imageChange",value:function(e){this.setState({image:e.target.value})}},{key:"submit",value:function(e,t,n,a){y({name:e,address:t,phoneNumber:n,image:a})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"AddGarage"},r.a.createElement("h1",null,"Ajouter un garage"),r.a.createElement("input",{type:"text",name:"Nom",value:this.state.name,placeholder:"Nom",onChange:function(t){return e.nameChange(t)},required:!0}),r.a.createElement("input",{type:"text",name:"adresse",placeholder:"Adresse",value:this.state.address,onChange:function(t){return e.addressChange(t)},required:!0}),r.a.createElement("input",{type:"text",name:"Num\xe9ro de t\xe9l\xe9phone",placeholder:"Num\xe9ro de t\xe9l\xe9phone",value:this.state.phoneNumber,onChange:function(t){return e.phoneNumberChange(t)},required:!0}),r.a.createElement("input",{type:"text",name:"image",placeholder:"Url de l'image",value:this.state.image,onChange:function(t){return e.imageChange(t)},required:!0}),r.a.createElement("button",{type:"submit",onClick:function(){return e.submit(e.state.name,e.state.address,e.state.phoneNumber,e.state.image)}},"Add"))}}]),n}(r.a.Component),M=function(e){var t=e.element,n=e.handleEditClick,a=e.index,o=e.renderTableHeader;return r.a.createElement("tr",null,o(t).map((function(e,n){return"image"!==e?r.a.createElement("td",null,t["".concat(e)]):r.a.createElement("img",{height:"60px",width:"60px",src:t["".concat(e)]})})),r.a.createElement("td",null,r.a.createElement("button",{type:"button",onClick:function(e){return n(e,a)}},"edit"),r.a.createElement("button",{type:"button",onClick:function(){return n.delete(t.id)}},"delete")))},q=(n(61),function(e){var t=e.handleEditClick,n=e.element,a=e.renderTableHeader;return r.a.createElement("tr",null,a(n).map((function(e,t){return r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:n["".concat(e)],placeholder:n["".concat(e)],value:n["".concat(e)],required:!0},n["".concat(e)]))})),r.a.createElement("td",null,r.a.createElement("button",{type:"button"},"save"),r.a.createElement("button",{type:"button",onClick:function(e){return t(e,null)}},"cancel")))}),H=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).handleEditClick=function(t,n){t.preventDefault(),e.setState({idEdit:n})},e.getAllElements=e.getAllGarage.bind(Object(T.a)(e)),e.deleteElement=e.deleteGarage.bind(Object(T.a)(e)),e.state={titles:[],elements:[],idEdit:null,idDelete:null},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.getAllElements().then((function(t){return e.setState({elements:t})})).catch((function(e){return console.error(e)}))}},{key:"renderTableHeader",value:function(e){var t=[];for(var n in console.log(e),e)"id"!==n&&t.push(n);return t}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("form",null,r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,this.renderTableHeader(this.state.elements[0]).map((function(e,t){return r.a.createElement("th",null,e)})),r.a.createElement("th",null,"Action"))),r.a.createElement("tbody",null,this.state.elements.map((function(t,n){return r.a.createElement(a.Fragment,null,e.state.idEdit===n?r.a.createElement(q,{handleEditClick:e.handleEditClick,element:t,renderTableHeader:e.renderTableHeader}):r.a.createElement(M,{element:t,handleEditClick:e.handleEditClick={delete:e.deleteGarage},index:n,renderTableHeader:e.renderTableHeader}))}))))),r.a.createElement(G,null))}}]),n}(r.a.Component),I=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={user:void 0},a}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){void 0===this.state.user&&this.setState({user:this.props.userStore})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(d.a,null,r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"/login",component:S}),r.a.createElement(m.b,{path:"/menu",render:function(){return void 0===e.state.user?r.a.createElement(m.a,{to:"/login"}):"mecano"===e.state.user.userType?r.a.createElement(A,null):r.a.createElement(m.a,{to:"/"})}}),r.a.createElement(m.b,{path:"/garages",render:function(){return void 0===e.state.user?r.a.createElement(m.a,{to:"/login"}):"mecano"===e.state.user.userType?r.a.createElement(H,{getAllElements:b,deleteElement:w}):r.a.createElement(m.a,{to:"/login"})}}),r.a.createElement(m.b,{path:"/",render:function(){return void 0===e.state.user?r.a.createElement(m.a,{to:"/login"}):"mecano"===e.state.user.userType?r.a.createElement(A,null):r.a.createElement(m.a,{to:"/login"})}}))))}}]),n}(r.a.Component);Object(p.b)((function(e){return console.log(e.login.userStore),{userStore:e.login.userStore}}))(I);var D=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(H,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var U=n(49),B=Object(U.b)(Object(U.a)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{user:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"login":return{userStore:t.payload.userInfo};default:return e}}}));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(p.a,{store:B},r.a.createElement(D,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},61:function(e,t,n){},72:function(e,t,n){e.exports=n(111)},77:function(e,t,n){},78:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t),n.d(t,"login",(function(){return l})),n.d(t,"getAllGarage",(function(){return d})),n.d(t,"deleteGarage",(function(){return m})),n.d(t,"postGarage",(function(){return p})),n.d(t,"updateGarage",(function(){return h}));var a=n(9),r=n.n(a),o=n(14),c=n(36),u=n.n(c),s="http://localhost:3001/",i={"Access-Control-Allow-Origin":"*"},l=function(){var e=Object(o.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post(s+"user/admin",{adresseMail:t,password:n},{headers:i}).catch((function(e){if(400===e.response.status)throw new Error("Les identifiants n'existent pas dans la base de donn\xe9es");if(404===e.response.status)throw new Error("Utilisateur inconnu pour cet administrateur");if(500===e.response.status)throw new Error("Erreur de connexion")}));case 2:return a=e.sent,i={Authorization:"Bearer "+a.data,"Accept-version":"1.0.0","Access-Control-Allow-Origin":"*"},console.log(a.data),e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),d=function(){var e=Object(o.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.get(s+"garage/",{headers:i}).catch((function(e){if(404===e.response.status)throw new Error("Garage inconnu");if(500===e.response.status)throw new Error("Erreur de connexion")}));case 2:return t=e.sent,console.log(JSON.stringify(t.data)),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(o.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.delete(s+"garage/",{headers:i,data:{id:t}}).catch((function(e){if(404===e.response.status)throw new Error("Garage inconnu")}));case 2:return n=e.sent,e.abrupt("return",n.status);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(o.a)(r.a.mark((function e(t,n,a,o){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,u.a.post(s+"garage/",{headers:i,data:{nom:t,adresse:n,numTel:a,image:o}}).catch((function(e){if(500===e.response.status)throw new Error("Erreur sdur le serveur");if(400===e.response.status)throw new Error("Erreur sur les \xe9l\xe9ments de la requ\xeate")}));case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),h=function(){var e=Object(o.a)(r.a.mark((function e(t,n,a,o){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.patch(s+"garage/",{headers:i,data:{id:t,nom:n,adresse:a,numTel:o}}).catch((function(e){if(500===e.response.status)throw new Error("Ressource manquante")}));case 2:return c=e.sent,e.abrupt("return",c.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}()}},[[72,1,2]]]);
//# sourceMappingURL=main.e7c3d94a.chunk.js.map